# Дашборд для визуализации метрик

Проект для создания аналитического дашборда, отображающего различные бизнес-метрики в реальном времени с использованием WebSocket для моментального обновления данных.

## Архитектура решения

### Бэкенд (Go)
- [x] Создание базовой структуры Go-проекта
- [x] Реализация сервиса генерации синтетических метрик
- [x] Интеграция с WebSocket для передачи данных
- [x] Реализация агрегации и предобработки данных
- [x] Настройка Redis для кэширования и управления состоянием
- [x] Graceful shutdown для корректного завершения работы
- [x] Реализация High Availability через балансировку между узлами
- [x] Реализация авторизации через OIDC (Google, Яндекс)
- [x] Контейнеризация бэкенд-сервисов с помощью Docker
- [x] Нагрузочное тестирование с использованием k6

### Фронтенд (Vue.js + TypeScript)
- [x] Создание базового проекта Vue.js с TypeScript
- [x] Настройка основных компонентов дашборда
- [x] Создание различных представлений для визуализации:
  - [x] Графики в реальном времени
  - [x] Тепловые карты
  - [x] Гистограммы и диаграммы
  - [x] Счетчики ключевых показателей
- [x] Реализация подключения к WebSocket
- [x] Оптимизация рендеринга
- [x] Ленивая загрузка компонентов для улучшения производительности
- [x] Создание адаптивного UI для разных устройств

## Основные функциональности

### 1. OIDC авторизация
Реализована поддержка авторизации через протокол OpenID Connect (OIDC) с возможностью подключения различных провайдеров:
- Google
- Яндекс

Особенности:
- Защита WebSocket соединений JWT токенами
- Ролевая модель доступа (RBAC)
- Управление сессиями с настраиваемым временем жизни токенов
- Двухфакторная аутентификация для административного доступа

Настройка OIDC выполняется через переменные окружения:
```sh
# Включение OIDC авторизации
ENABLE_OIDC=true

# Настройки OIDC провайдера
OIDC_PROVIDER_URL=https://accounts.google.com
OIDC_CLIENT_ID=your-client-id
OIDC_CLIENT_SECRET=your-client-secret
OIDC_REDIRECT_URL=http://localhost:8080/auth/callback

# Секрет для подписи JWT токенов
JWT_SECRET=your-secret-key
```

### 2. High Availability и масштабирование
Система спроектирована с учетом требований высокой доступности:
- Репликация данных между экземплярами через Redis
- Поддержка кластерного развертывания
- Балансировка нагрузки между узлами
- Автоматическое обнаружение и использование доступных экземпляров

Настройка Redis для High Availability:
```sh
REDIS_ADDR=localhost:6379
REDIS_PASSWORD=your-redis-password
```

### 3. Graceful Shutdown
Реализовано корректное завершение работы сервиса:
- Обработка сигналов операционной системы (SIGINT, SIGTERM)
- Безопасное закрытие активных WebSocket соединений
- Завершение обработки всех текущих запросов
- Корректное освобождение ресурсов

### 4. Нагрузочное тестирование
Включены инструменты для тестирования производительности системы:
- Скрипты k6 для проверки WebSocket соединений
- Тестирование с различными профилями нагрузки
- Проверка пороговых значений задержки и пропускной способности

Запуск нагрузочного тестирования:
```sh
# Установка k6
go install go.k6.io/k6@latest

# Запуск теста
k6 run backend/k6_load_test.js
```

## Запуск проекта

### Используя Docker Compose

1. Запустите все сервисы с помощью Docker Compose:
   ```
   docker-compose up -d
   ```

2. Откройте дашборд в браузере:
   ```
   http://localhost:3000
   ```

### Ручной запуск

1. Перейти в директорию бэкенда:
   ```
   cd backend
   ```

2. Запустить сервер:
   ```
   go run main.go
   ```

3. Перейти в директорию фронтенда:
   ```
   cd frontend
   ```

4. Установить зависимости и запустить:
   ```
   npm install
   npm run dev
   ```

5. Открыть в браузере:
   ```
   http://localhost:3000
   ```

## Переменные окружения

### Бэкенд

| Переменная | Описание | Значение по умолчанию |
|------------|----------|------------------------|
| `SERVER_ADDR` | Адрес и порт сервера | `:8080` |
| `REDIS_ADDR` | Адрес Redis для High Availability | `localhost:6379` |
| `REDIS_PASSWORD` | Пароль для Redis | `""` |
| `ENABLE_OIDC` | Включение OIDC авторизации | `""` (отключено) |
| `OIDC_PROVIDER_URL` | URL OIDC провайдера | `https://accounts.google.com` |
| `OIDC_CLIENT_ID` | Client ID для OIDC | `""` |
| `OIDC_CLIENT_SECRET` | Client Secret для OIDC | `""` |
| `OIDC_REDIRECT_URL` | URL перенаправления после авторизации | `http://localhost:8080/auth/callback` |
| `JWT_SECRET` | Секрет для подписи JWT | `"secret"` |

## Дальнейшие улучшения
- Реализация интеграции с реальными источниками данных
- Расширение возможностей настройки дашборда пользователем
- Добавление уведомлений о критических событиях
- Сохранение истории метрик в базу данных
- Внедрение машинного обучения для предсказания трендов

